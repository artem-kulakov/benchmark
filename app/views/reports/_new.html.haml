- # Header
.page-header
  %h3 New report
  %p= "#{Industry.find(session[:industry]).title}, #{Period.find(session[:period]).title}"


- # Form
= form_for @report, html: {class: "form-horizontal"} do |f|
  - if @report.errors.any?
    #error_explanation
      %h2= "#{pluralize(@report.errors.count, "error")} prohibited this report from being saved:"
      %ul
        - @report.errors.full_messages.each do |msg|
          %li= msg


  - # Choose company
  .form-group
    = f.label :company, class: "col-sm-2 control-label"
    .col-sm-2
      = f.select :company_id, options_from_collection_for_select(@companies, :id, :title, @report.company_id), {}, {class: "form-control"}
      = f.hidden_field :period_id, :value => session[:period]
  
  
  - # Choose accounting standard
  .form-group
    = f.label :accounting_standard, class: "col-sm-2 control-label"
    .col-sm-2
      = f.select :accounting_standard_id, options_from_collection_for_select(AccountingStandard.all, :id, :title), {prompt: 'Select'}, {class: "form-control"}

  
  - # Indicators' values
  = f.fields_for :versions do |v|
    = v.hidden_field :user_id, :value => current_user.id
    = v.hidden_field :rating, :value => current_user.rating

    - @indicators.each do |i|
      .form-group
        = v.label "", i.title, class: "col-sm-2 control-label"
        = v.fields_for :values do |val|
          .col-sm-2
            = val.text_field :value, class: "form-control"
            = val.hidden_field :indicator_id, :value => i.id
          .col-sm-2
            = val.select :unit, options_for_select(@currencies, 'RUB'), {prompt: 'Select'}, {class: "form-control"}

  - # Buttons
  .form-group
    .col-sm-offset-2.col-sm-2
      %ul.list-inline
        %li= f.submit 'Save', class: "btn btn-success"
        %li= link_to 'Cancel', reports_path(industry: @industry.id, period: @period.id), class: "btn btn-default"
